{% extends 'users/profile.html' %}
{% load static %}

{% block body %}

<div class="container">

        <div class="row">
            <div class="col-lg-6 wow fadeInUp" data-wow-delay=".2s">

                <div class="single-featuer">
                    <img class="shape" src="{% static 'hackaton/images/features/shape.svg'%}" alt="#">
                    <img class="shape2" src="{% static 'hackaton/images/features/shape2.svg' %}" alt="#">
                     <form id="form-container" action="{% url 'users:command' %}" method="post">
                        {% csrf_token %}
                        <div class="form-floating">
                          <input type="text" class="form-control" name="team" id="floatingName" placeholder="team name">
                          <label for="floatingName">Название команды(необязательно)</label>
                        </div>

                        <div class="form-floating" id="form-nick">
                          <input type="text" class="form-control" name="name" id="form-name_0" placeholder="count">
                          <label for="form-name_0">nickname участника</label>
                        </div>

                        <div>
                            <input type="hidden" name="form-INITIAL_FORMS" value="0" id="id_form-INITIAL_FORMS">
                            <input type="hidden" name="form-TOTAL_FORMS" value="1" id="id_form-TOTAL_FORMS">
                        </div>

                        <button id="add-form" class="w-100 btn btn-outline-success" type="button" style="margin-bottom: 5px; margin-top: 5px">Добавить участника</button>
                        <button id="del-form" class="w-100 btn btn-outline-danger" type="button" style="margin-bottom: 5px">Удалить участника</button>
                        <button class="w-100 btn btn-lg btn-primary" type="submit">Зарегистрироваться</button>
                      </form>
                </div>
            </div>
        </div>

         <div class="row">
            <div class="col-lg-6 wow fadeInUp" data-wow-delay=".2s">

                <div class="single-featuer">
                    <img class="shape" src="{% static 'hackaton/images/features/shape.svg'%}" alt="#">
                    <img class="shape2" src="{% static 'hackaton/images/features/shape2.svg' %}" alt="#">
                    <h3>Команды, которые уже записались на участие</h3>
                         {% for team in teams %}
                            <p>{{ team.name }}</p>
                        {% endfor %}
                </div>
            </div>
        </div>
</div>

   <script>

        let nickForm = document.querySelectorAll("#form-nick")
        let container = document.querySelector("#form-container")
        let addButton = document.querySelector("#add-form")
        let delButton = document.querySelector("#del-form")
        let totalForms = document.querySelector("#id_form-TOTAL_FORMS")
        let formNum = nickForm.length-1

        addButton.addEventListener('click', addForm)
        delButton.addEventListener('click', delForm)

        function addForm(e){
           e.preventDefault()

            if (totalForms.getAttribute('value') < 4){
                let newForm = nickForm[0].cloneNode(true)
                let formRegex = RegExp(`name_(\\d){1}`,'g')

                formNum++
                newForm.innerHTML = newForm.innerHTML.replace(formRegex, `name_${formNum}`)
                container.insertBefore(newForm, addButton)
                totalForms.setAttribute('value', `${formNum+1}`)
            }
        }

        function delForm(e){+
            e.preventDefault()

            if (totalForms.getAttribute('value') > 1){
                let form = document.querySelector(`#form-name_${formNum}`)
                let form1 = document.querySelector(`#form-name_${formNum}`)
                form.parentElement.remove()
                form1.parentElement.remove()
                formNum--
                totalForms.setAttribute('value', `${formNum+1}`)
            }
        }
    </script>

{% endblock %}